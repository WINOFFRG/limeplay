---
title: use-player
description: Hook for initializing and managing Shaka Player instance, loading assets, and preloading
---

import { Step, Steps } from "fumadocs-ui/components/steps"

## Installation

<Steps>
<Step>
### Install the hook
```npm
npx shadcn add @limeplay/use-player
```
</Step>

<Step>
### Add to PlayerHooks
Import the `usePlayerStates` hook in your existing `PlayerHooks` component.

```tsx lineNumbers title="components/limeplay/player-hooks.tsx"
import React from "react"

import { usePlayerStates } from "@/hooks/limeplay/use-player" // [!code ++]

export const PlayerHooks = React.memo(() => {
  usePlayerStates() // [!code ++]

  return null
})
```

</Step>

<Step>
### Add the Store States

```tsx lineNumbers title="lib/create-media-store.ts"
import { createPlayerStore, PlayerStore } from "@/hooks/limeplay/use-player"

// [!code ++]

export type TypeMediaStore = PlayerStore & // [!code ++]
  {}

export function createMediaStore(initProps?: Partial<CreateMediaStoreProps>) {
  const mediaStore = create<TypeMediaStore>()((...etc) => ({
    ...createPlayerStore(...etc), // [!code ++]
    ...initProps,
  }))
  return mediaStore
}
```

</Step>
</Steps>

## Example Usage

The `usePlayer` hook provides methods to load and preload assets.

```tsx lineNumbers title="components/player/load-button.tsx"
import { usePlayer } from "@/hooks/limeplay/use-player"

export function LoadButton() {
  const { load, preload } = usePlayer({
    onError: (error, asset) => console.error("Error loading asset", asset, error),
    onLoad: async (asset, player, media) => {
        // Custom load logic if needed, or just:
        await player.load(asset.src)
    }
  })

  const handleLoad = () => {
    load({ id: "1", src: "https://..." })
  }

  return <button onClick={handleLoad}>Load Asset</button>
}
```

## Understanding

The `use-player` hook (formerly `use-shaka-player`) handles the Shaka Player instance and asset loading lifecycle.

- **Initialization**: `usePlayerStates` automatically loads the Shaka Player library and attaches it to the media element.
- **Loading**: `usePlayer` provides a `load` function that uses a custom `onLoad` callback to handle asset loading.
- **Preloading**: Supports preloading assets for instant playback.
- **Events**: Synced with Zustand store (`onPlayerReady`, `onBufferingChange`, `onError`).

### Debug Mode

When `debug` is enabled in the store, the hook loads the debug build of Shaka Player.

## API Reference

### usePlayerStates()

Initializes Shaka Player and attaches it to the media element. Also syncs player events like buffering to the store.

### usePlayer(options)

Returns methods to interact with the player.

#### Options

<AutoTypeTable path="./registry/default/hooks/use-player.ts" name="UsePlayerOptions" />

#### Returns

<AutoTypeTable path="./registry/default/hooks/use-player.ts" name="UsePlayerReturn" />

### Store State

The player instance and events are stored in the media store:

<AutoTypeTable path="./registry/default/hooks/use-player.ts" name="PlayerStore" />
