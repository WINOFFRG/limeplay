{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "use-timeline-states",
  "type": "registry:hook",
  "registryDependencies": [
    "https://limeplay.winoffrg.dev/r/styles/default/media-provider.json",
    "https://limeplay.winoffrg.dev/r/styles/default/utils.json"
  ],
  "files": [
    {
      "path": "registry/default/hooks/use-timeline-states.ts",
      "content": "import { useEffect } from \"react\"\n\nimport { off, on } from \"@/registry/default/lib/utils\"\nimport { useMediaStore } from \"@/registry/default/ui/media-provider\"\n\nexport function useTimelineStates() {\n  const mediaRef = useMediaStore((state) => state.mediaRef)\n  const duration = useMediaStore((state) => state.duration)\n  const setDuration = useMediaStore((state) => state.setDuration)\n  const currentTime = useMediaStore((state) => state.currentTime)\n  const setCurrentTime = useMediaStore((state) => state.setCurrentTime)\n\n  useEffect(() => {\n    if (mediaRef && mediaRef.current) {\n      const updatedCurrentTime = (\n        event: React.SyntheticEvent<HTMLVideoElement, Event>\n      ) => {\n        console.log(\"native time :: \", event.currentTarget.currentTime)\n        setCurrentTime(event.currentTarget.currentTime)\n      }\n\n      const updateDuration = (\n        event: React.SyntheticEvent<HTMLVideoElement, Event>\n      ) => {\n        setDuration(event.currentTarget.duration)\n      }\n\n      if (mediaRef.current.readyState >= 2) {\n        console.log(\"Setting Duration to :: \", mediaRef.current.duration)\n        setDuration(mediaRef.current.duration)\n        return\n      } else {\n        console.warn(\n          \"Didnt set duration because :: \",\n          mediaRef.current.readyState\n        )\n      }\n\n      on(mediaRef.current, \"timeupdate\", updatedCurrentTime)\n      on(\n        mediaRef.current,\n        [\"canplay\", \"canplaythrough\", \"durationchange\"],\n        updateDuration\n      )\n\n      return () => {\n        const mediaElement = mediaRef.current\n        if (mediaElement) {\n          off(mediaElement, \"timeupdate\", updatedCurrentTime)\n          off(\n            mediaElement,\n            [\"canplay\", \"canplaythrough\", \"durationchange\"],\n            updateDuration\n          )\n        }\n      }\n    }\n  }, [mediaRef])\n}\n",
      "type": "registry:hook"
    }
  ]
}