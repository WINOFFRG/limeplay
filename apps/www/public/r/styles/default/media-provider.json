{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "media-provider",
  "type": "registry:ui",
  "dependencies": [
    "zustand"
  ],
  "registryDependencies": [
    "https://limeplay.winoffrg.dev/r/styles/default/create-media-store.json",
    "https://limeplay.winoffrg.dev/r/styles/default/use-media-state.json",
    "https://limeplay.winoffrg.dev/r/styles/default/use-player-root-store.json",
    "https://limeplay.winoffrg.dev/r/styles/default/use-timeline.json",
    "https://limeplay.winoffrg.dev/r/styles/default/use-volume.json"
  ],
  "files": [
    {
      "path": "registry/default/ui/media-provider.tsx",
      "content": "\"use client\"\n\nimport React, { createContext, useContext, useRef } from \"react\"\nimport { useStore } from \"zustand\"\n\nimport type {\n  CreateMediaStoreProps,\n  TypeMediaStore,\n} from \"@/registry/default/internal/create-media-store\"\nimport { createMediaStore } from \"@/registry/default/internal/create-media-store\"\n\ntype MediaProviderContext = ReturnType<typeof createMediaStore>\n\nconst MediaProviderContext = createContext<MediaProviderContext | null>(null)\n\nexport function MediaProvider({\n  children,\n  ...props\n}: React.PropsWithChildren<CreateMediaStoreProps>) {\n  const store = useRef(createMediaStore(props)).current\n\n  return (\n    <MediaProviderContext.Provider value={store}>\n      {children}\n    </MediaProviderContext.Provider>\n  )\n}\n\nfunction useMediaStoreWithContext<T>(\n  selector: (state: TypeMediaStore) => T\n): T {\n  const storeFromCtx = useContext(MediaProviderContext)\n\n  if (!storeFromCtx) {\n    throw new Error(\"Missing MediaProvider in root\")\n  }\n\n  return useStore(storeFromCtx, selector)\n}\n\nlet globalStore: ReturnType<typeof createMediaStore> | null = null\n\n// DEV: Migrate to conditional calling without context\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction useMediaStoreWithoutContext<T>(\n  selector: (state: TypeMediaStore) => T,\n  options?: CreateMediaStoreProps\n): T {\n  globalStore ??= createMediaStore(options ?? {})\n\n  return useStore(globalStore, selector)\n}\n\nexport function useGetStore() {\n  const storeFromCtx = useContext(MediaProviderContext)\n\n  if (!storeFromCtx) {\n    throw new Error(\"Missing MediaProvider in root\")\n  }\n\n  return storeFromCtx\n}\n\nexport const useMediaStore = useMediaStoreWithContext\n",
      "type": "registry:ui"
    },
    {
      "path": "registry/default/internal/create-media-store.ts",
      "content": "import { create } from \"zustand\"\n\nimport type { MediaStateStore } from \"@/registry/default/hooks/use-media-state\"\nimport { createMediaStateStore } from \"@/registry/default/hooks/use-media-state\"\nimport type { PlayerRootStore } from \"@/registry/default/hooks/use-player-root-store\"\nimport { createPlayerRootStore } from \"@/registry/default/hooks/use-player-root-store\"\nimport type { TimelineStore } from \"@/registry/default/hooks/use-timeline\"\nimport { createTimelineStore } from \"@/registry/default/hooks/use-timeline\"\nimport type { VolumeStore } from \"@/registry/default/hooks/use-volume\"\nimport { createVolumeStore } from \"@/registry/default/hooks/use-volume\"\n\nexport type TypeMediaStore = PlayerRootStore &\n  VolumeStore &\n  MediaStateStore &\n  TimelineStore\n// & {}\n\nexport interface CreateMediaStoreProps {\n  debug?: boolean\n}\n\nexport function createMediaStore(initProps?: Partial<CreateMediaStoreProps>) {\n  const mediaStore = create<TypeMediaStore>()((...etc) => ({\n    ...createPlayerRootStore(...etc),\n    ...createVolumeStore(...etc),\n    ...createMediaStateStore(...etc),\n    ...createTimelineStore(...etc),\n    ...initProps,\n  }))\n  return mediaStore\n}\n",
      "type": "registry:lib"
    }
  ]
}